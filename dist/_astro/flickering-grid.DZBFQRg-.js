import{j}from"./jsx-runtime.CRkqtJS5.js";import{r as l}from"./index.B52nOzfP.js";const N=({squareSize:c=4,gridGap:d=6,flickerChance:v=.3,color:b="rgb(0, 0, 0)",width:R,height:C,className:p,maxOpacity:h=.3})=>{const $=l.useRef(null),y=l.useRef(null),[g,E]=l.useState(!1),[A,k]=l.useState({width:0,height:0}),I=l.useMemo(()=>(n=>{if(typeof window>"u")return"rgba(0, 0, 0,";const t=document.createElement("canvas");t.width=t.height=1;const s=t.getContext("2d");if(!s)return"rgba(255, 0,";s.fillStyle=n,s.fillRect(0,0,1,1);const[r,i,o]=Array.from(s.getImageData(0,0,1,1).data);return`rgba(${r}, ${i}, ${o},`})(b),[b]),x=l.useCallback((e,n,t)=>{const s=window.devicePixelRatio||1;e.width=n*s,e.height=t*s,e.style.width=`${n}px`,e.style.height=`${t}px`;const r=Math.floor(n/(c+d)),i=Math.floor(t/(c+d)),o=new Float32Array(r*i);for(let a=0;a<o.length;a++)o[a]=Math.random()*h;return{cols:r,rows:i,squares:o,dpr:s}},[c,d,h]),F=l.useCallback((e,n)=>{for(let t=0;t<e.length;t++)Math.random()<v*n&&(e[t]=Math.random()*h)},[v,h]),M=l.useCallback((e,n,t,s,r,i,o)=>{e.clearRect(0,0,n,t),e.fillStyle="transparent",e.fillRect(0,0,n,t);for(let a=0;a<s;a++)for(let f=0;f<r;f++){const m=i[a*r+f];e.fillStyle=`${I}${m})`,e.fillRect(a*(c+d)*o,f*(c+d)*o,c*o,c*o)}},[I,c,d]);return l.useEffect(()=>{const e=$.current,n=y.current;if(!e||!n)return;const t=e.getContext("2d");if(!t)return;let s,r;const i=()=>{const u=R||n.clientWidth,w=C||n.clientHeight;k({width:u,height:w}),r=x(e,u,w)};i();let o=0;const a=u=>{if(!g)return;const w=(u-o)/1e3;o=u,F(r.squares,w),M(t,e.width,e.height,r.cols,r.rows,r.squares,r.dpr),s=requestAnimationFrame(a)},f=new ResizeObserver(()=>{i()});f.observe(n);const m=new IntersectionObserver(([u])=>{E(u.isIntersecting)},{threshold:0});return m.observe(e),g&&(s=requestAnimationFrame(a)),()=>{cancelAnimationFrame(s),f.disconnect(),m.disconnect()}},[x,F,M,R,C,g]),j.jsx("div",{ref:y,className:`w-full h-full ${p}`,children:j.jsx("canvas",{ref:$,className:"pointer-events-none",style:{width:A.width,height:A.height,margin:"auto"}})})};export{N as default};
