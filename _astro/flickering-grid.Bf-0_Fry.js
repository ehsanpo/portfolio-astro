import{j as M}from"./jsx-runtime.CDeAccHH.js";import{r as l}from"./index.C17Z0mLS.js";import"./index.D2MAbzvX.js";const P=({squareSize:c=4,gridGap:m=6,flickerChance:v=.3,color:b="rgb(0, 0, 0)",width:R,height:C,className:j,maxOpacity:d=.3})=>{const $=l.useRef(null),x=l.useRef(null),[g,E]=l.useState(!1),[y,k]=l.useState({width:0,height:0}),A=l.useMemo(()=>(n=>{if(typeof window>"u")return"rgba(0, 0, 0,";const t=document.createElement("canvas");t.width=t.height=1;const s=t.getContext("2d");if(!s)return"rgba(255, 0,";s.fillStyle=n,s.fillRect(0,0,1,1);const[r,i,o]=Array.from(s.getImageData(0,0,1,1).data);return`rgba(${r}, ${i}, ${o},`})(b),[b]),I=l.useCallback((e,n,t)=>{const s=window.devicePixelRatio||1;e.width=n*s,e.height=t*s,e.style.width=`${n}px`,e.style.height=`${t}px`;const r=Math.floor(n/(c+m)),i=Math.floor(t/(c+m)),o=new Float32Array(r*i);for(let a=0;a<o.length;a++)o[a]=Math.random()*d;return{cols:r,rows:i,squares:o,dpr:s}},[c,m,d]),p=l.useCallback((e,n)=>{for(let t=0;t<e.length;t++)Math.random()<v*n&&(e[t]=Math.random()*d)},[v,d]),F=l.useCallback((e,n,t,s,r,i,o)=>{e.clearRect(0,0,n,t),e.fillStyle="transparent",e.fillRect(0,0,n,t);for(let a=0;a<s;a++)for(let f=0;f<r;f++){const h=i[a*r+f];e.fillStyle=`${A}${h})`,e.fillRect(a*(c+m)*o,f*(c+m)*o,c*o,c*o)}},[A,c,m]);return l.useEffect(()=>{const e=$.current,n=x.current;if(!e||!n)return;const t=e.getContext("2d");if(!t)return;let s,r;const i=()=>{const u=R||n.clientWidth,w=C||n.clientHeight;k({width:u,height:w}),r=I(e,u,w)};i();let o=0;const a=u=>{if(!g)return;const w=(u-o)/1e3;o=u,p(r.squares,w),F(t,e.width,e.height,r.cols,r.rows,r.squares,r.dpr),s=requestAnimationFrame(a)},f=new ResizeObserver(()=>{i()});f.observe(n);const h=new IntersectionObserver(([u])=>{E(u.isIntersecting)},{threshold:0});return h.observe(e),g&&(s=requestAnimationFrame(a)),()=>{cancelAnimationFrame(s),f.disconnect(),h.disconnect()}},[I,p,F,R,C,g]),M.jsx("div",{ref:x,className:`w-full h-full ${j}`,children:M.jsx("canvas",{ref:$,className:"pointer-events-none max-w-full",style:{width:y.width,height:y.height,margin:"auto"}})})};export{P as default};
